<%= link_to "Home", root_path %>

<h3>User Show page</h3>

<h4> UserName: <%= current_user.email %></h4>
<p> ID: <%= current_user.id %></p>

<h2>My requests</h2>

<%= form_tag users_path, :method => 'get' do %>
	
	<p>
		<%= text_field_tag :search, params[:search] %>
		<%= submit_tag "Search", :name => nil %>
		<%= button_tag 'CLEAR', id: 'clear_form_button' %>
	</p>
<% end %>
<%#= javascript_pack_tag 'clear' %>
 <script type='text/javascript'>
 	$(document).ready(function () {

 		$("#clear_form_button").on("click", function() {
 		  $("#search").val("");
 		});
 	});
 </script>
<hr>
<h3>User list</h3>
<div id="users">
	<% if user_signed_in?  %>
		<% @users.each do |user| %>

		
		
		<%# User.all.where.not(id: current_user.id).each do |user| %>
			<% if user.try(:type) != 'AdminUser' %>
				<div class="user">
					<p>
						<%#= user.id %> 
						
						
						<!-- ############ -->
						<% if signed_in? && !Invitation.reacted?(current_user.id, user.id) && current_user != user  %>
							<% if params[:search].present? %>
								<div  class="show-view" >		
									<td><%= user.email %></td>
								  	<td> <%= link_to 'Send Invitation',
								    invitations_create_path(ids: {id1: current_user.id, id2: user.id})

								  %></td>
								</div>
							<% else %>
								<div  class="hide-view" >	
									<td><%= user.email %></td>
							  		<td> <%= link_to 'Send Invitation',
							    	invitations_create_path(ids: {id1: current_user.id, id2: user.id})

							  		%></td>
							  	</div>
							<% end %>
						<% elsif signed_in? && Invitation.confirmed_record?(current_user.id, user.id) && current_user != user  %>
							
								<td><%= user.email %></td>
							   	<td><b>Friend</b></td>
							   	<td>
								<% user.invitations.each do |invitation| %>
							   	 	
							   	 	<%= link_to 'Unfriend',
				      invitations_destroy_path(invitation_id: invitation.id) %>
				      				
							   	
							   	<% end %>

							   		<%#= link_to 'Unfriend',
							   	      invitations_destroy_path(invitation_id: user.invitations.ids) %>
							   	</td>
						   	 
						<% end %>
						<!-- ############ -->
					</p>
				</div>
			<% end %>
		<% end %>
	<% end %>
</div>
<!-- ################################## -->


<hr>


<%# if user_signed_in?  %>
		
		<% @users.each do |user| %>
		<%# User.all.where.not(:id=>current_user.id).each do |user| %>
		
			
			<ol>
			  <% user.invitations.each do |invitation| %>
			    <%  if invitation.confirmed != true && user.id != current_user.id %>
			    <h3> These people wants to be friend with you </h3>	
			    <li>
			      <%#= User.find(invitation.user_id).email %>
			      
			      	<%= User.find(invitation.user_id).email %>
			      <%# end %>
			      <%= link_to 'Accept Invitation',
			      invitations_update_path(invitation_id: invitation.id) %> - 
			      <%= link_to 'Reject Invitation',
			      invitations_destroy_path(invitation_id: invitation.id) %>
			    </li>
			    <% end %>
			  <% end %>
			</ol>
			
		<% end %>
<%# end %>
<!-- ################################## -->












